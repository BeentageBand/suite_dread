/*=====================================================================================*/
/**
 * api.cpp
 * author : puch
 * date : Oct 22 2015
 *
 * description : Any comments
 *
 */
/*=====================================================================================*/

/*=====================================================================================*
 * Project Includes
 *=====================================================================================*/
#include "dread_threadable.h"
/*=====================================================================================* 
 * Standard Includes
 *=====================================================================================*/

/*=====================================================================================* 
 * Local X-Macros
 *=====================================================================================*/
using namespace dread;
/*=====================================================================================* 
 * Local Define Macros
 *=====================================================================================*/

/*=====================================================================================* 
 * Local Type Definitions
 *=====================================================================================*/

/*=====================================================================================* 
 * Local Object Definitions
 *=====================================================================================*/

/*=====================================================================================* 
 * Exported Object Definitions
 *=====================================================================================*/

/*=====================================================================================* 
 * Local Function Prototypes
 *=====================================================================================*/

/*=====================================================================================* 
 * Local Inline-Function Like Macros
 *=====================================================================================*/

/*=====================================================================================* 
 * Local Function Definitions
 *=====================================================================================*/

/*=====================================================================================* 
 * Exported Function Definitions
 *=====================================================================================*/
Thread::Thread(const int thread_id)
: dread_id(thread_id)
{
   this->thread_id = 0;
   this->is_alive = false;
   pthread_attr_init(&this->attributes);
}

void Thread::run(void)
{
   this->thread_id = pthread_create(&this->thread_id, &this->attributes, Thread::thread_func,this);
   pthread_detach(this->thread_id);
}

int Thread::run_thread(void)
{
   this->is_alive = true;
   int sout = on_thread();
   this->is_alive = false;
   return sout;
}

void Thread::initialize(void)
{
   this->run();
}

void Thread::shutdown(void)
{

}

void * Thread::thread_func(void * argv)
{
   int * sout = new int(-1);
   if(nullptr != argv)
   {
      Thread * t = static_cast<Thread *>(argv);
      *sout = t->run_thread();
   }
   return sout;
}
/*=====================================================================================* 
 * api.cpp
 *=====================================================================================*
 * Log History
 *
 *=====================================================================================*/


